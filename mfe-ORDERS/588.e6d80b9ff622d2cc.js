(self.webpackChunkmfe_ORDERS=self.webpackChunkmfe_ORDERS||[]).push([[588],{2588:(D,d,e)=>{e.r(d),e.d(d,{AuthService:()=>l,CoreServicesComponent:()=>r,CoreServicesService:()=>a,ProductCategory:()=>O,RoleService:()=>c,SalesDataService:()=>P,SalesStatus:()=>m,UserRole:()=>t});var n=e(4332);let a=(()=>{class h{constructor(){}static{this.\u0275fac=function(E){return new(E||h)}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})();var u=e(467),s=e(3425),i=e(4230);let l=(()=>{class h{constructor(o){this.http=o,this.id="auth of pokemon",this.ISSUER_BASE_URL="https://topfix-wrczmn.us1.zitadel.cloud",this.CLIENT_ID="336777344075263315",this.REDIRECT_URI="https://opensourcekd.github.io/pokemon/#/auth-callback",this.SCOPE="openid profile email",this.TOKEN_KEY="zitadel_token",this.USER_INFO_KEY="zitadel_user_info",this.userSubject=new s.BehaviorSubject(this.getUserInfoFromStorage()),this.user$=this.userSubject.asObservable(),console.log("In constructor of auth service in pokemon")}login(o){o&&console.log(`[AuthService] Logged in: ${o}`),this.redirectToZitadelLogin()}redirectToZitadelLogin(){const o=new URL(`${this.ISSUER_BASE_URL}/oauth/v2/authorize`),E=this.generateRandomState(),I=this.generateCodeVerifier();sessionStorage.setItem("oauth_state",E),sessionStorage.setItem("code_verifier",I),o.searchParams.append("client_id",this.CLIENT_ID),o.searchParams.append("redirect_uri",this.REDIRECT_URI),o.searchParams.append("response_type","code"),o.searchParams.append("scope",this.SCOPE),o.searchParams.append("state",E),window.location.href=o.toString()}handleCallback(o,E){var I=this;return(0,u.A)(function*(){const v=sessionStorage.getItem("oauth_state");if(E!==v)return console.error("State mismatch - possible CSRF attack"),!1;try{const _=yield I.exchangeCodeForToken(o);I.setToken(_.access_token);const S=I.decodeIdToken(_.id_token);return I.setUserInfo(S),sessionStorage.removeItem("oauth_state"),sessionStorage.removeItem("code_verifier"),!0}catch(_){return console.error("Error exchanging code for token:",_),!1}})()}exchangeCodeForToken(o){var E=this;return(0,u.A)(function*(){const I=`${E.ISSUER_BASE_URL}/oauth/v2/token`,v=new URLSearchParams({grant_type:"authorization_code",code:o,redirect_uri:E.REDIRECT_URI,client_id:E.CLIENT_ID}),_=yield fetch(I,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:v.toString()});if(!_.ok)throw new Error(`Token exchange failed: ${_.statusText}`);return _.json()})()}decodeIdToken(o){try{const E=o.split(".")[1],I=JSON.parse(atob(E));return{sub:I.sub,name:I.name,email:I.email}}catch(E){return console.error("Error decoding ID token:",E),{sub:""}}}logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_INFO_KEY),this.userSubject.next(null)}getToken(){return localStorage.getItem(this.TOKEN_KEY)}setToken(o){localStorage.setItem(this.TOKEN_KEY,o)}isAuthenticated(){return!!this.getToken()}getUser(){return this.userSubject.value}getUserInfoFromStorage(){const o=localStorage.getItem(this.USER_INFO_KEY);return o?JSON.parse(o):null}setUserInfo(o){localStorage.setItem(this.USER_INFO_KEY,JSON.stringify(o)),this.userSubject.next(o)}generateRandomState(){const o=new Uint8Array(32);return crypto.getRandomValues(o),Array.from(o,E=>E.toString(16).padStart(2,"0")).join("")}generateCodeVerifier(){const o=new Uint8Array(32);return crypto.getRandomValues(o),Array.from(o,E=>E.toString(16).padStart(2,"0")).join("")}static{this.\u0275fac=function(E){return new(E||h)(n.\u0275\u0275inject(i.HttpClient))}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})(),r=(()=>{class h{static{this.\u0275fac=function(E){return new(E||h)}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:h,selectors:[["org-core-services"]],standalone:!0,features:[n.\u0275\u0275StandaloneFeature],decls:2,vars:0,template:function(E,I){1&E&&(n.\u0275\u0275elementStart(0,"p"),n.\u0275\u0275text(1," core-services works! "),n.\u0275\u0275elementEnd())}})}}return h})();var t=function(h){return h.SUPER_ADMIN="super-admin",h.ORG_ADMIN="org-admin",h.TEAM_LEAD="team-lead",h.SALES_EXECUTIVE="sales-executive",h}(t||{});let c=(()=>{class h{constructor(o){this.currentUserSubject=new s.BehaviorSubject(this.getDummyUser()),this.currentUser$=this.currentUserSubject.asObservable(),this.dataService=o}getCurrentUser(){return this.currentUserSubject.value}setCurrentUser(o){this.currentUserSubject.next(o)}hasRole(o){return this.getCurrentUser()?.role===o}hasAnyRole(o){const E=this.getCurrentUser();return!!E&&o.includes(E.role)}isAdmin(){return this.hasAnyRole([t.SUPER_ADMIN,t.ORG_ADMIN])}isTeamLeadOrHigher(){return this.hasAnyRole([t.SUPER_ADMIN,t.ORG_ADMIN,t.TEAM_LEAD])}getAllUsers(){return[{id:"user-1",name:"John Admin",email:"john.admin@company.com",role:t.SUPER_ADMIN},{id:"user-2",name:"Sarah Manager",email:"sarah.manager@company.com",role:t.ORG_ADMIN},{id:"user-3",name:"Mike Lead",email:"mike.lead@company.com",role:t.TEAM_LEAD,teamId:"team-1"},{id:"user-4",name:"Alice Sales",email:"alice.sales@company.com",role:t.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"},{id:"user-5",name:"Bob Sales",email:"bob.sales@company.com",role:t.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"},{id:"user-6",name:"Carol Sales",email:"carol.sales@company.com",role:t.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"}]}getViewableUsers(){const o=this.getCurrentUser();if(!o)return[];const E=this.getAllUsers();return this.isTeamLeadOrHigher()?E.filter(I=>I.role===t.SALES_EXECUTIVE||I.id===o.id):E.filter(I=>I.id===o.id)}getDummyUser(){return{id:"user-4",name:"Alice Sales",email:"alice.sales@company.com",role:t.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"}}static{this.\u0275fac=function(E){return new(E||h)(n.\u0275\u0275inject("DataService",8))}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})();var f=e(3103),m=function(h){return h.COMPLETED="completed",h.PENDING="pending",h.CANCELLED="cancelled",h}(m||{}),O=function(h){return h.ELECTRONICS="Electronics",h.SOFTWARE="Software",h.SERVICES="Services",h.HARDWARE="Hardware",h}(O||{});let P=(()=>{class h{constructor(o){this.dummySalesData=this.generateDummyData(),this.dataService=o}getSalesHistory(o,E,I){if(this.dataService)return this.dataService.getSalesHistory(o,E,I);let v=this.dummySalesData.filter(_=>_.salesExecutiveId===o);return E&&(v=v.filter(_=>_.date>=E)),I&&(v=v.filter(_=>_.date<=I)),(0,s.of)(v).pipe((0,f.c)(300))}getSalesSummary(o){if(this.dataService)return this.dataService.getSalesSummary(o);const E=this.dummySalesData.filter(v=>v.salesExecutiveId===o),I={totalSales:E.filter(v=>v.status===m.COMPLETED).reduce((v,_)=>v+_.amount,0),totalCommission:E.filter(v=>v.status===m.COMPLETED).reduce((v,_)=>v+_.commission,0),completedCount:E.filter(v=>v.status===m.COMPLETED).length,pendingCount:E.filter(v=>v.status===m.PENDING).length,cancelledCount:E.filter(v=>v.status===m.CANCELLED).length};return(0,s.of)(I).pipe((0,f.c)(300))}getAllSales(){return this.dataService?this.dataService.getAllSales():(0,s.of)(this.dummySalesData).pipe((0,f.c)(300))}generateDummyData(){const o=[{name:"Enterprise Software License",category:O.SOFTWARE,basePrice:5e4},{name:"Cloud Storage Solution",category:O.SERVICES,basePrice:25e3},{name:"Server Hardware",category:O.HARDWARE,basePrice:35e3},{name:"IoT Device Package",category:O.ELECTRONICS,basePrice:15e3},{name:"Consulting Services",category:O.SERVICES,basePrice:2e4},{name:"Mobile App Development",category:O.SOFTWARE,basePrice:45e3},{name:"Security Suite",category:O.SOFTWARE,basePrice:3e4},{name:"Network Infrastructure",category:O.HARDWARE,basePrice:6e4}],E=["Acme Corporation","Tech Innovations Inc","Global Solutions Ltd","Digital Dynamics","Future Systems","Smart Technologies","Enterprise Solutions","Cloud Masters"],I=["North","South","East","West","Central"],v=[{id:"user-4",name:"Alice Sales"},{id:"user-5",name:"Bob Sales"},{id:"user-6",name:"Carol Sales"}],_=[m.COMPLETED,m.COMPLETED,m.COMPLETED,m.PENDING,m.CANCELLED],S=[];let M=1;for(let A=0;A<50;A++){const g=v[A%v.length],T=o[Math.floor(Math.random()*o.length)],y=E[Math.floor(Math.random()*E.length)],L=I[Math.floor(Math.random()*I.length)],p=_[Math.floor(Math.random()*_.length)],U=T.basePrice+(1e4*Math.random()-5e3),K=.05*U,R=new Date;R.setDate(R.getDate()-Math.floor(180*Math.random())),S.push({id:"sale-"+M++,salesExecutiveId:g.id,salesExecutiveName:g.name,productName:T.name,productCategory:T.category,amount:Math.round(U),commission:Math.round(K),status:p,date:R,clientName:y,region:L})}return S.sort((A,g)=>g.date.getTime()-A.date.getTime())}static{this.\u0275fac=function(E){return new(E||h)(n.\u0275\u0275inject("DataService",8))}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()},8399:(D,d,e)=>{e.d(d,{_:()=>a});var n=e(6129);class a{constructor(s,i=a.now){this.schedulerActionCtor=s,this.now=i}schedule(s,i=0,l){return new this.schedulerActionCtor(this,s).schedule(l,i)}}a.now=n.U.now},2688:(D,d,e)=>{e.d(d,{x:()=>s});var n=e(9131),a=e(9326),u=e(9724);function s(...i){return(0,n.K)()((0,u.H)(i,(0,a.lI)(i)))}},983:(D,d,e)=>{e.d(d,{I:()=>u,w:()=>a});var n=e(1985);const a=new n.c(i=>i.complete());function u(i){return i?function s(i){return new n.c(l=>i.schedule(()=>l.complete()))}(i):a}},9724:(D,d,e)=>{e.d(d,{H:()=>u});var n=e(5894),a=e(8750);function u(s,i){return i?(0,n.c)(s,i):(0,a.Tg)(s)}},1807:(D,d,e)=>{e.d(d,{O:()=>i});var n=e(1985),a=e(3236),u=e(9470),s=e(8211);function i(l=0,r,t=a.b){let c=-1;return null!=r&&((0,u.m)(r)?t=r:c=r),new n.c(f=>{let m=(0,s.v)(l)?+l-t.now():l;m<0&&(m=0);let O=0;return t.schedule(function(){f.closed||(f.next(O++),0<=c?this.schedule(void 0,c):f.complete())},m)})}},9131:(D,d,e)=>{e.d(d,{K:()=>a});var n=e(6365);function a(){return(0,n.U)(1)}},3103:(D,d,e)=>{e.d(d,{c:()=>s});var n=e(3236),a=e(3183),u=e(1807);function s(i,l=n.E){const r=(0,u.O)(i,l);return(0,a.o)(()=>r)}},3183:(D,d,e)=>{e.d(d,{o:()=>r});var n=e(2688),a=e(6697),u=e(3557),s=e(3703),i=e(3028),l=e(8750);function r(t,c){return c?f=>(0,n.x)(c.pipe((0,a.s)(1),(0,u.w)()),f.pipe(r(t))):(0,i.Z)((f,m)=>(0,l.Tg)(t(f,m)).pipe((0,a.s)(1),(0,s.u)(f)))}},3557:(D,d,e)=>{e.d(d,{w:()=>s});var n=e(9974),a=e(4360),u=e(5343);function s(){return(0,n.N)((i,l)=>{i.subscribe((0,a._)(l,u.l))})}},6354:(D,d,e)=>{e.d(d,{T:()=>u});var n=e(9974),a=e(4360);function u(s,i){return(0,n.N)((l,r)=>{let t=0;l.subscribe((0,a._)(r,c=>{r.next(s.call(i,c,t++))}))})}},3703:(D,d,e)=>{e.d(d,{u:()=>a});var n=e(6354);function a(u){return(0,n.T)(()=>u)}},6365:(D,d,e)=>{e.d(d,{U:()=>u});var n=e(3028),a=e(3669);function u(s=1/0){return(0,n.Z)(a.D,s)}},5412:(D,d,e)=>{e.d(d,{h:()=>s});var n=e(8750),a=e(5225),u=e(4360);function s(i,l,r,t,c,f,m,O){const P=[];let h=0,C=0,o=!1;const E=()=>{o&&!P.length&&!h&&l.complete()},I=_=>h<t?v(_):P.push(_),v=_=>{f&&l.next(_),h++;let S=!1;(0,n.Tg)(r(_,C++)).subscribe((0,u._)(l,M=>{c?.(M),f?I(M):l.next(M)},()=>{S=!0},void 0,()=>{if(S)try{for(h--;P.length&&h<t;){const M=P.shift();m?(0,a.N)(l,m,()=>v(M)):v(M)}E()}catch(M){l.error(M)}}))};return i.subscribe((0,u._)(l,I,()=>{o=!0,E()})),()=>{O?.()}}},3028:(D,d,e)=>{e.d(d,{Z:()=>l});var n=e(6354),a=e(8750),u=e(9974),s=e(5412),i=e(8071);function l(r,t,c=1/0){return(0,i.T)(t)?l((f,m)=>(0,n.T)((O,P)=>t(f,O,m,P))((0,a.Tg)(r(f,m))),c):("number"==typeof t&&(c=t),(0,u.N)((f,m)=>(0,s.h)(f,m,r,c)))}},941:(D,d,e)=>{e.d(d,{Q:()=>s});var n=e(5225),a=e(9974),u=e(4360);function s(i,l=0){return(0,a.N)((r,t)=>{r.subscribe((0,u._)(t,c=>(0,n.N)(t,i,()=>t.next(c),l),()=>(0,n.N)(t,i,()=>t.complete(),l),c=>(0,n.N)(t,i,()=>t.error(c),l)))})}},6745:(D,d,e)=>{e.d(d,{_:()=>a});var n=e(9974);function a(u,s=0){return(0,n.N)((i,l)=>{l.add(u.schedule(()=>i.subscribe(l),s))})}},6697:(D,d,e)=>{e.d(d,{s:()=>s});var n=e(983),a=e(9974),u=e(4360);function s(i){return i<=0?()=>n.w:(0,a.N)((l,r)=>{let t=0;l.subscribe((0,u._)(r,c=>{++t<=i&&(r.next(c),i<=t&&r.complete())}))})}},7119:(D,d,e)=>{e.d(d,{S:()=>i});var n=e(1985),a=e(4761),u=e(8071),s=e(5225);function i(l,r){return new n.c(t=>{let c;return(0,s.N)(t,r,()=>{c=l[a.l](),(0,s.N)(t,r,()=>{let f,m;try{({value:f,done:m}=c.next())}catch(O){return void t.error(O)}m?t.complete():t.next(f)},0,!0)}),()=>(0,u.T)(c?.return)&&c.return()})}},5894:(D,d,e)=>{e.d(d,{c:()=>v});var n=e(8750),a=e(941),u=e(6745),l=e(1985),t=e(7119),c=e(5225);function f(_,S){if(!_)throw new Error("Iterable cannot be null");return new l.c(M=>{(0,c.N)(M,S,()=>{const A=_[Symbol.asyncIterator]();(0,c.N)(M,S,()=>{A.next().then(g=>{g.done?M.complete():M.next(g.value)})},0,!0)})})}var m=e(5055),O=e(9858),P=e(7441),h=e(5397),C=e(7953),o=e(591),E=e(5196);function v(_,S){if(null!=_){if((0,m.l)(_))return function s(_,S){return(0,n.Tg)(_).pipe((0,u._)(S),(0,a.Q)(S))}(_,S);if((0,P.X)(_))return function r(_,S){return new l.c(M=>{let A=0;return S.schedule(function(){A===_.length?M.complete():(M.next(_[A++]),M.closed||this.schedule())})})}(_,S);if((0,O.y)(_))return function i(_,S){return(0,n.Tg)(_).pipe((0,u._)(S),(0,a.Q)(S))}(_,S);if((0,C.T)(_))return f(_,S);if((0,h.x)(_))return(0,t.S)(_,S);if((0,E.U)(_))return function I(_,S){return f((0,E.C)(_),S)}(_,S)}throw(0,o.L)(_)}},6780:(D,d,e)=>{e.d(d,{R:()=>i});var n=e(3961);class a extends n.yU{constructor(r,t){super()}schedule(r,t=0){return this}}const u={setInterval(l,r,...t){const{delegate:c}=u;return c?.setInterval?c.setInterval(l,r,...t):setInterval(l,r,...t)},clearInterval(l){const{delegate:r}=u;return(r?.clearInterval||clearInterval)(l)},delegate:void 0};var s=e(7908);class i extends a{constructor(r,t){super(r,t),this.scheduler=r,this.work=t,this.pending=!1}schedule(r,t=0){var c;if(this.closed)return this;this.state=r;const f=this.id,m=this.scheduler;return null!=f&&(this.id=this.recycleAsyncId(m,f,t)),this.pending=!0,this.delay=t,this.id=null!==(c=this.id)&&void 0!==c?c:this.requestAsyncId(m,this.id,t),this}requestAsyncId(r,t,c=0){return u.setInterval(r.flush.bind(r,this),c)}recycleAsyncId(r,t,c=0){if(null!=c&&this.delay===c&&!1===this.pending)return t;null!=t&&u.clearInterval(t)}execute(r,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const c=this._execute(r,t);if(c)return c;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(r,t){let f,c=!1;try{this.work(r)}catch(m){c=!0,f=m||new Error("Scheduled action threw falsy error")}if(c)return this.unsubscribe(),f}unsubscribe(){if(!this.closed){const{id:r,scheduler:t}=this,{actions:c}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,s.o)(c,this),null!=r&&(this.id=this.recycleAsyncId(t,r,null)),this.delay=null,super.unsubscribe()}}}},707:(D,d,e)=>{e.d(d,{q:()=>a});var n=e(8399);class a extends n._{constructor(s,i=n._.now){super(s,i),this.actions=[],this._active=!1}flush(s){const{actions:i}=this;if(this._active)return void i.push(s);let l;this._active=!0;do{if(l=s.execute(s.state,s.delay))break}while(s=i.shift());if(this._active=!1,l){for(;s=i.shift();)s.unsubscribe();throw l}}}},3236:(D,d,e)=>{e.d(d,{E:()=>u,b:()=>s});var n=e(6780);const u=new(e(707).q)(n.R),s=u},6129:(D,d,e)=>{e.d(d,{U:()=>n});const n={now:()=>(n.delegate||Date).now(),delegate:void 0}},9326:(D,d,e)=>{e.d(d,{R0:()=>l,lI:()=>i,ms:()=>s});var n=e(8071),a=e(9470);function u(r){return r[r.length-1]}function s(r){return(0,n.T)(u(r))?r.pop():void 0}function i(r){return(0,a.m)(u(r))?r.pop():void 0}function l(r,t){return"number"==typeof u(r)?r.pop():t}},5225:(D,d,e)=>{function n(a,u,s,i=0,l=!1){const r=u.schedule(function(){s(),l?a.add(this.schedule(null,i)):this.unsubscribe()},i);if(a.add(r),!l)return r}e.d(d,{N:()=>n})},8211:(D,d,e)=>{function n(a){return a instanceof Date&&!isNaN(a)}e.d(d,{v:()=>n})},9470:(D,d,e)=>{e.d(d,{m:()=>a});var n=e(8071);function a(u){return u&&(0,n.T)(u.schedule)}},467:(D,d,e)=>{function n(u,s,i,l,r,t,c){try{var f=u[t](c),m=f.value}catch(O){return void i(O)}f.done?s(m):Promise.resolve(m).then(l,r)}function a(u){return function(){var s=this,i=arguments;return new Promise(function(l,r){var t=u.apply(s,i);function c(m){n(t,l,r,c,f,"next",m)}function f(m){n(t,l,r,c,f,"throw",m)}c(void 0)})}}e.d(d,{A:()=>a})}}]);